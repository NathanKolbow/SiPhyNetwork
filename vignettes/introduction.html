<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Josh Justison" />


<title>Introduction</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction</h1>
<h3 class="subtitle">An R Package for Simulating Phylogenetic Networks</h3>
<h4 class="author">Josh Justison</h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The NetSim R package is a tool for simulating phylogenetic networks under birth-death-hybridization based models. It provides functions for creating complex hybridization models, functions for simulating phylogenies under these models, as well as utility functions for characterizing the types of phylogenetic networks, visualizing networks, and saving phylogenetic networks in the Extended Newick format. This allows users to simulate phylogenetic networks under a suite of more biologically realistic models. The Netsim package is released under the GPL-3 license and is available for download from <a href="https://github.com/jjustison/NetSim">GitHub</a></p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Birth-death processes are commonly used to describe species diversification <em><span class="citation">(Nee 2006)</span></em>. There exist several phylogenetic simulation tools that generate trees under the birth-death process <em><span class="citation">(See Stadler 2011)</span></em> as well as extentions for density-dependent diversification , time-dependent rates <em><span class="citation">(Höhna 2013; Höhna, May, and Moore 2015)</span></em>, lineage age dependent rates <em><span class="citation">(Hagen and Stadler 2018)</span></em>, and fossilisation <em><span class="citation">(Barido-Sottani et al. 2019)</span></em>.</p>
<p>Gene flow and hybridization is found throughout the tree of life and has had a nontrivial role in shaping diversity <em><span class="citation">(Mallet, Besansky, and Hahn 2016)</span></em>. Recently, an extension of the birth-death process that includes hybridization was developed as a prior for Bayesian phylogenetic inference <em><span class="citation">(Zhang et al. 2018)</span></em>. This model assumes the waiting time between hybridizations is exponentially distributed with rate parameter <span class="math inline">\({ntaxa \choose 2}\nu\)</span>, where <span class="math inline">\(\nu\)</span> is the hybridization rate. A few tools exist that simulate phylogenetic networks under variants of this model <em><span class="citation">(Morin and Moret 2006; Woodhams, Lockhart, and Holland 2016; Davín et al. 2020)</span></em>, however they all have different conceptualizations on how hybridization events affect the number of lineages on the phylogeny. As process-based phylogenetic inference methods receive increased attention, it becomes imperative that we can simulate biologically relevant phylogenetic network for the testing of these methods and for creating hypotheses about empirical systems.</p>
</div>
<div id="the-netsim-package" class="section level1">
<h1>The Netsim Package</h1>
<p>The Netsim R package allows simulation of phylogenetic networks under a birth-death-hybridization process. This package extends the capabilities of other existing birth-death-hybridization based simulators by allowing:</p>
<ul>
<li>Simulating to a fixed time or fixed number of species</li>
<li>Incomplete sampling sampling</li>
<li>Sampling of extinct taxa</li>
<li>Hybridization events to be either a lineage generating, a lineage neutral, or a lineage degenerative process.<br />
</li>
<li>Successful hybridization events to be an arbitrary function of genetic distance</li>
<li>Successful hybridization events to be dependent on a trait that evolves along the network</li>
<li>Functions for visualizing, writing, and reading phylogenetic networks in R</li>
</ul>
<p>Throughout this vignette we will cover how to use these features in NetSim.</p>
<div id="simulating-networks" class="section level2">
<h2>Simulating Networks</h2>
<p>There are three core functions for simulating phylogenetic networks: <code>sim.bdh.age</code>, <code>sim.bdh.taxa.ssa</code>, and <code>sim.bdh.taxa.gsa</code> (collectively refered to as <code>sim.bdh</code> style functions). These functions all use the same birth-death-hybridization models but differ in their stopping conditions.</p>
<ul>
<li>The <code>sim.bdh.age</code> function simulates until a specified <code>age</code>.</li>
<li>The <code>sim.bdh.taxa.ssa</code> function uses the Simple Sampling Approach (SSA) to simulate to a specified number of taxa <code>n</code>, that is, the simulation will stop once the phylogeny has <code>n</code> tips.</li>
<li>The <code>sim.bdh.taxa.gsa</code> function uses the General Sampling Approach (GSA) to simulate to a specified number of taxa <code>n</code>. Briefly, the GSA simulates <code>m</code> taxa under the SSA and samples the phylogeny from time periods where <code>n</code> taxa are present.</li>
</ul>
<p>Both the SSA and GSA are described with greater detail in <em><span class="citation">Hartmann, Wong, and Stadler (2010)</span></em> and <em><span class="citation">Stadler (2011)</span></em>.</p>
<div id="example-1-simulating-networks-under-a-simple-hybridization-model" class="section level3">
<h3>Example 1: Simulating Networks Under A Simple Hybridization Model</h3>
<p>The <code>sim.bdh</code> style functions have many optional arguments with default values. For this first set of simulations we won’t adjust any optional arguments, we’ll be playing with these arguments in later sections. However, it is important to know the assumptions we are making with our model by using default parameters. Specifically, we assume:</p>
<ul>
<li><code>frac = 1</code> and <code>stochsampling = FALSE</code> assumes that all extant taxa are sampled in the phylogeny.</li>
<li><code>mrca=TRUE</code> means that we start with a single lineage rather than the MRCA of two lineages</li>
<li><code>complete = TRUE</code> leaves extinct species on the phylogeny.</li>
<li><code>hyb.rate.fxn = NULL</code> assumes that successful hybridization events are not a function of the genetic distance between taxa.</li>
<li><code>trait.model = NULL</code> assumes that successful hybridization events do not depend on a trait value between taxa.</li>
</ul>
<p>The arguments we will be using are:</p>
<ul>
<li><code>age</code>, <code>m</code>, and <code>n</code>: These parameters are used for the stopping condition of the simulations.</li>
<li><code>numbsim</code>: The number of simulations performed</li>
<li><code>lambda</code>: The speciation rate</li>
<li><code>mu</code> The extinction rate</li>
<li><code>nu</code> The hybridization rate</li>
<li><code>hybprops</code>: A vector of length three that denotes the proportion of hybridizations that are lineage generative, lineage degenerative, and lineage neutral.</li>
<li><code>hyb.inher.fxn</code>: This is a function used for determining the inheritance proportions.</li>
</ul>
<p>Now we can try running some simulations</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NetSim)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82589933</span>) <span class="do">##set the seed for reproducibility. This is the exponent of the largest known Mersenne prime number</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##First we need a function that describes how inheritance probabilities are drawn</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>inheritance.fxn <span class="ot">&lt;-</span> <span class="fu">make.beta.draw</span>(<span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##We can see that this function makes draws from a beta(10,10) distribution</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">inheritance.fxn</span>() </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4893861</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">inheritance.fxn</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4677096</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##We also want to set the proportion of each type of hybrid event</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>hybrid_proportions <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,  <span class="do">##Lineage Generative</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.25</span>, <span class="do">##Lineage Degenerative</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.25</span>) <span class="do">##Lineage Neutral</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">##We can simulate to 7 extant tips with the SSA</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ssa_nets<span class="ot">&lt;-</span><span class="fu">sim.bdh.taxa.ssa</span>(<span class="at">n=</span><span class="dv">7</span>,<span class="at">numbsim=</span><span class="dv">20</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.20</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>ssa_net<span class="ot">&lt;-</span>ssa_nets[[<span class="dv">20</span>]] <span class="do">##The sim.bdh functions return a list of length numbsim. We get the 20th simulation</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ssa_net)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Evolutionary network with 2 reticulations</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                --- Base tree ---</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Phylogenetic tree with 8 tips and 12 internal nodes.</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tip labels:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   t2, t4, t7, t6, t9, t8, ...</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rooted; includes branch lengths.</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="do">##We can also simulate 7 extant taxa with the GSA. </span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="do">##We choose m=30 because it becomes very unlikely that at 30 tips we will ever return to 7</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>gsa_nets<span class="ot">&lt;-</span><span class="fu">sim.bdh.taxa.gsa</span>(<span class="at">m=</span><span class="dv">30</span>,<span class="at">n=</span><span class="dv">7</span>,<span class="at">numbsim=</span><span class="dv">20</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.6</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.3</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>gsa_net<span class="ot">&lt;-</span>gsa_nets[[<span class="dv">19</span>]]</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="do">##Simulate a network up to age 2</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>age_nets <span class="ot">&lt;-</span><span class="fu">sim.bdh.age</span>(<span class="at">age=</span><span class="dv">2</span>,<span class="at">numbsim=</span><span class="dv">20</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.25</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>age_net<span class="ot">&lt;-</span>age_nets[[<span class="dv">8</span>]]</span></code></pre></div>
<p>There are a few things worth noting here. Firstly, if we looked at <code>age_nets</code> we would notice that some of the elements are <code>0</code>, the <code>sim.bdh</code> style functions return <code>0</code> if the phylogeny goes extinct before reaching the stopping condition.</p>
<p>Secondly, we can see that each phylogeny is an <code>evonet</code> object, however, they have an additional attribute <code>inheritance</code>. <code>inheritance</code> contains a vector of inheritance probabilities. The <span class="math inline">\(i^{th}\)</span> element in <code>inheritance</code> corresponds to the inheritance probability of the hybrid edge denoted in the <span class="math inline">\(i^{th}\)</span> row of the <code>reticulation</code> attribute.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>age_net<span class="sc">$</span>inheritance <span class="do">##This corresponds to the edges found in reticulation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3674308 0.3716242 0.4939105 0.5539802</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>age_net<span class="sc">$</span>reticulation</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      from to</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    9 10</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   15 18</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]   17 21</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]   22 20</span></span></code></pre></div>
<p>Further, we can use the <code>gsa.network()</code> function to sample phylogenies under the GSA. This allows us to properly sample <span class="math inline">\(n\)</span> taxa from any phylogenetic model, regardless if the phylogenetic networks were generated from the <code>NetSim</code> package or not.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">##We can simulate to 30 extant tips under the SSA. In this case the 30 acts as the m parameter of the GSA</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ssa_nets<span class="ot">&lt;-</span><span class="fu">sim.bdh.taxa.ssa</span>(<span class="at">n=</span><span class="dv">30</span>,<span class="at">numbsim=</span><span class="dv">10</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.20</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>my_net<span class="ot">&lt;-</span>ssa_nets[[<span class="dv">1</span>]]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>my_net<span class="ot">&lt;-</span><span class="fu">network.gsa</span>(<span class="at">net=</span>my_net,<span class="at">ntaxa=</span><span class="dv">5</span>,<span class="at">complete=</span>T,<span class="at">frac=</span><span class="dv">1</span>,<span class="at">stochsampling=</span>F)</span></code></pre></div>
<p>Lastly, Most of the arguments in the <code>sim.bdh</code> type functions take either a numeric or boolean, however, <code>hyb.inher.fxn</code>, <code>hyb.rate.fxn</code> take functions as arguments while <code>trait.model</code> takes a list of functions as an argument. These take functions as arguments so the user can define functions as they please to model the specific biology of interest. Some utility functions exist to aid in creating functions that fit the specific purpose of these arguments.</p>
<p>For example, when simulating above, we used <code>make.beta.draw(10,10)</code> to create a function that makes draws from a beta distribution with shape parameters 10 and 10. We might chose a beta function like this if we believed that inheritance proportions are generally equal but have some variation. Alternatively, <code>make.uniform.draw()</code>, and <code>make.categorical.draw()</code> are other utility functions for creating appropriate functions for the <code>hyb.inher.fxn</code> argument. In fact, any function will work as long as that function requires no arguments itself and returns values on the range <span class="math inline">\([0,1]\)</span>.</p>
<p>We will explore how to appropriately make arguments for <code>hyb.rate.fxn</code> and <code>trait.model</code> later in this vignette.</p>
</div>
</div>
<div id="characterizing-and-using-phylogenetic-networks" class="section level2">
<h2>Characterizing And Using Phylogenetic Networks</h2>
<p>After simulating phylogenetic networks it can be helpful to identify certain characteristics of the networks and eventually save those networks to file so they can be used in other pipelines.</p>
<div id="example-2-plotting-networks" class="section level3">
<h3>Example 2 Plotting Networks</h3>
<p>One of the first ways of understanding the type of phylogenetic networks we generated would be to plot them</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ssa_net,<span class="at">main=</span><span class="st">&quot;SSA Network&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gsa_net,<span class="at">main=</span><span class="st">&quot;GSA Network&quot;</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in min(x): no non-missing arguments to min; returning Inf</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in max(x): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(age_net,<span class="at">main=</span><span class="st">&quot;Age Network&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>A few odd things happened here when we tried plotting the networks we simulated. We will go over these network by network.</p>
<ul>
<li>The <strong>SSA network</strong> only shows one hybridization event although we can see from the <code>reticulation</code> element that there are two events. This occurs when there is a hybridization where the two donor lineages have the same parental node. We can identify where this occurs on the phylogeny by using <code>nodelabels()</code>. We can notice nodes <span class="math inline">\(15\)</span> and <span class="math inline">\(17\)</span> sitting on the edge between <span class="math inline">\(11\)</span> and <span class="math inline">\(18\)</span>. In fact, if we looked at the <code>reticulation</code> element of our network we would notice gene flow from node <span class="math inline">\(15\)</span> to node <span class="math inline">\(17\)</span> so this is indeed where the hybridization occurs. Although only one edge is drawn between these nodes, we can imagine another hybrid edge between <span class="math inline">\(15\)</span> and <span class="math inline">\(17\)</span>.</li>
<li>From the <strong>GSA network</strong> figure we can notice two issues. Firstly, it looks cut off or was plotting incorrectly. While the edge and reticulation matrix would confirm that the network is properly conformed, the plotting function of <code>ape</code> doesn’t always render networks correctly. Secondly, the GSA network has a diagonal hybrid edge, and while this isn’t improper, it does muddle the interpretation of the phylogeny. The diagonal line would seem to imply that there was gene flow from a lineage in the past to a more recent lineage. This clearly isn’t the case as no lineages that we know of can time travel. These diagonal hybrid edges can result from incomplete lineage sampling, gene flow from a now extinct species, or lineage degenerative hybridization but it can still be hard to interpret diagonal edges.</li>
<li>In the <strong>Age network</strong> we can see the same issue with one of the hybrid edges not appearing as in the <strong>SSA netowrk</strong>. However, this tree also is a good example of all three different type of hybridization. We can see lineage neutral hybridization between <span class="math inline">\(t7\)</span> and <span class="math inline">\(t8\)</span>. After looking at the <code>reticulation</code> element we can see that the gene flow goes from the <span class="math inline">\(t7\)</span> lineage to the <span class="math inline">\(t8\)</span> lineage. Next, we can see lineage generating hybridization with the vertical blue line from lineage <span class="math inline">\(t3\)</span> to lineage <span class="math inline">\(t8\)</span>. Although, the gene flow looks like it goes from <span class="math inline">\(t3\)</span> to a common ancestor of <span class="math inline">\(t9\)</span> and <span class="math inline">\(t4\)</span>, using <code>nodelabels()</code> and the <code>reticulation</code> element we can confirm where the hybridization occurs. Lastly, we can see lineage degenerative hybridization with diagonal edge denoting gene flow from lineage <span class="math inline">\(t9\)</span> to lineage <span class="math inline">\(t3\)</span>.</li>
</ul>
<p>We correct these issues by using the <code>plottable.net()</code> function to modify the phylogeny to a more plotting-friendly network where gene flow always occurs between contemporary lineages. We aren’t changing anything fundamental about the network, just how the edges get drawn.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ssa_pnet <span class="ot">&lt;-</span><span class="fu">plottable.net</span>(ssa_net)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>gsa_pnet <span class="ot">&lt;-</span><span class="fu">plottable.net</span>(gsa_net)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>age_pnet <span class="ot">&lt;-</span><span class="fu">plottable.net</span>(age_net)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ssa_pnet,<span class="at">main=</span><span class="st">&quot;SSA Network&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gsa_pnet,<span class="at">main=</span><span class="st">&quot;GSA Network&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(age_pnet,<span class="at">main=</span><span class="st">&quot;Age Network&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAGACAMAAAA6QU9cAAAAwFBMVEUAAAAAADoAAGYAAH8AOjoAOmYAOpAAZmYAZrY6AAA6ADo6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZgBmZjpmkGZmkLZmkNtmtttmtv+AgP+QOgCQZjqQkGaQtpCQttuQtv+Q27aQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2tma225C229u22/+2/9u2///bkDrbkGbbtmbbtpDb25Db29vb////tmb/25D/27b/29v//7b//9v///999YWpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJzUlEQVR4nO2d7ULbNhhGZdqlZGwrI7RbC0v3Vbf7zOqWDpMR3/9dzdIrOwmx80Rx5FjoOT8AR4klHSTZ6EWyKshW1LELMHQoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQK+CcqVOPsB3pUpdl9/uJ+p0PWHxG/6wnGCHXHalV0Fl1U3d4btGtw2C5pc71jtYQWWV1cNW0YDVuCFo53oHKyhXyXdV2RfvlPrirVRF/5yc31Zv04LKl62gOlG/rE5emtYlvTA3X29eKPX0lf50ppKfLtXJLLUfP5kdoNB9CkrV6PNYXegfF1Nd3eTMVkXzxYf6bSUXVtAyUQT9qZK35sUL21Iyk260ZfYn/XqZQfnGA9CjoLJaF2W5dVX0L//0dpGappLqX/WdNVeYer8sXxdBK4nGR/njtf5SppXnOtU/lifMjLDy62hW/Kvf+M90l9FuF3oUlOvfaSa/WOlbuhtoEVpNVg8cZdpfpREjaDXRfMZYyUwnNK7seFM1pmt7gpeq9t2RHgWl+nctjaFqSKnUU6i6hH4xVcmvE2kgdaK4yEwfejZJ3mbSk0Z2+KnlS2c8TAfrU1Bd17JG1RVK1zlXDYLKNz/T71lNFEG5UXc1VRdaeHUiM16vCRJx3elPUFbVtazKgxa0Plosx97TYjWx7pbfjHXzeaZ7X1sLGv0e3Bgk1y0l9X4wBjXc79h7ptXEerjRrSO3TW59DKoEmbMepgn1JqhsC6aqpaiyLutXseSqmC8rVI011mSdaOufV+bMB9avYktB9iapO70Jqi4x8kPDfVA9qtata+U+SCfmcgOpxzI5wak93fI+aEVQ1fm60pcgaTga+Z3rG+Sv5Z63mL8p6/y8vu21vSYXA8tEc/M9K+wtYC3c3Em/1j+tCVq9s+rCcac70kNda/xxJEHl6HO+HJeGzJEEVfc3h7qd88exutj8RTm0JM8P8fe2XzjlCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAY4gSD3pP8/9OYagH/rPc38oCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIEL6gxXtZW5772cQhfEGZiLkbH2hPrgeELyg1u1tsbNN0KEIXJPsILf4Yn3na5SJ0QcXdl6WYj1/9nXnaRyY8QWqd3G5LlHraRyZAQeuHtuUspn7G6PAF2ZZzN/YzRgcv6H4iLafqaQcndEFVy/E1RgcvKJer+2Lqa6+v0AXdT81ed1VPOzyhC/IOBQ0rO5MlBYEsKQhkSUEgyx0FqRb8lm6jFP1mZ7LcVZDTy76goP1K4TVLCgJZUhDIkoJAlhQEsjyGoMX7WfVcBrc/a2MRVM8XpY4TR7EIqub0M9eZxzgEVU/h2GPqOg5BEj3ba+IxQEHbedL4qp3Tz93Dr+EJAjSfXMbofWauIxEkY/QeDSgSQXZO3/USv38pOnEEQXLx2iv0EYcg6Vv79LBIBEn0bK/oaxyCOkBBXkrRLUsKAllSEMiSgkCWFASypCCQJQWBLCkIZElBIEsKAllSEMjyGILMqrL5pX5+stv5YhGk/5K/G397u0gd4z5eBIF59WMI0nOumTx/3S3wE0cLkriYmZi2AaCdiUOQaMmTn4v59NGHni3N8a+tcbH/9H8vnDvOKoYryClPPfzcT0az4pNr7DkSQWaMNtcv15WJcQgyAR9RQ0FNmGu7UXM/YRdrwETEcnXlfhGLRJDExW7O3C9ikQjqAAV1KoWfLCkIZElBIEsKAllSEMiyXdD6X5hbzxKpoNaDDSiIgpqSWg82oCAKakpqPdiAgiioKan1YAMKoqCmpNaDDSiIgpqSWg82QIKqMNnOxdqlSP3QkyD51vm/YShot/P0yZ6CHoaYUS7yLSZB64cUREFNSa0HFCRJrQcUJEmtBxQkSa0HFCRJrQcUJEmtBxQkSa0HUNDGvyXKyxTUkswWREEU1JTUekBBktR6QEGS1HpAQZLUetBVkFkvdnOmnv6yWyFbz9sDRxGk1yLkyVXxyXWLnFgEpad2f6Ww/9PelyCzXuyzWSnmuolQHILMejHZKjDsrUoPKWht+ZiWY9Yj3E/YxdaweemOtZiObudTRUFr2LzM0Dy/VMn3YS+o8yVouUFg4LsB+xKk14uZh/y5b6UYhyAzPmcnM/flYgELap5BfIjtYnq92OLNHsvFwhX08CTbB+n9oSAABQEoCEBBAAoCDFnQ1us4BYE0CgJpFATSKAikPWZBbZtHbV/HG4+gLfgTZOJixR4PZ4lFUBXMSB2fvxaNIBsOy5Qa/pTrFnwJqp4vlic/BhBZ3YK3FiTbS96Nr50fPvJ4BDWzEhfTE9LuD9B6NIJaWIuLnYYxab8Fb4L0GK2Dzq47ucYiSDccPVBrYr0PamEZFzO4P4ItDkHVk8XCeErmFrx1sancQDvvwxmLoA5QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBIhFUP18sQAeXbMFf4Lk+WIXxTyAtRpb8CeomnO1a34OU6T+8TflKnGxwn0tQhyClpP1N+PHG3puDHghVuNi+uk1rqH5gAR1ogqoLtLHG3ruRL2U1zlyGIegpRYKakTHxSQ25hxajUOQiYulo5m5V3QjDkGyXuzdWCVXrh+NQ1AHhlWkYZXGMKwiDas0hmEVaVilMQyrSMMqjWFYRRpWaQzDKtKwSmMYVpGGVRrDsIo0rNIYhlWkYZXGMKwiDas0hmEVaVilMQyrSP5KY+JimZ59dZxSjEWQrEVwneso4hGk51zd1yEUsQiSuFju/G/2RSyCpPGkT89U8trxkwMT5AsdF7ufnN+GHjj0xnKhYQBblR6D5Ra3FNTESjQsgN2Aj0C9j+Jy5diuxCFI9lEsv8wnYa969oWsF/s4VsmrsFccDhAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQ4H838zlgVybQkQAAAABJRU5ErkJggg==" /></p>
</div>
<div id="example-3-network-input-and-output" class="section level3">
<h3>Example 3 Network Input And Output</h3>
<p>Now that we’ve gotten a look at the networks we may wish to save these networks to file. We will be using the rich Newick Format for saving the phylogenies <em><span class="citation">(Cardona, Rosselló, and Valiente 2008; but see Wen et al. 2018)</span></em>. Notaby, the <code>ape</code> function <code>write.evonet</code> does not save inheritance probabilities to file so we defined <code>write.net</code> for this purpose</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.evonet</span>(ssa_net,<span class="at">file=</span><span class="st">&#39;&#39;</span>) <span class="do">##we can see that inheritance probabilities aren&#39;t included here</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;((((((((t9:0.08909672167,t8:0.08909672167):0.09893002096,t6:0.07316472041):0.05853474425,t7:0.2465614869):0.01184385441)#H17:0.1968426302,#H17:0.1968426302):0.05603563838,#H13:0):0.2327367459,((t4:0.4728885618,(t3:0.06939401066,t1:0.06939401066):0.4034945512):0.03839504799,(t2:0.5112836098)#H13:0):0.2327367459):0.105329951);&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>my_newick<span class="ot">&lt;-</span><span class="fu">write.net</span>(ssa_net,<span class="at">file =</span> <span class="st">&#39;&#39;</span>) <span class="do">## if we include a file name the network will print to file instead of print on the console</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_newick)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;((((((((t9:0.08909672167,t8:0.08909672167):0.09893002096,t6:0.07316472041):0.05853474425,t7:0.2465614869):0.01184385441)#H17:0.1968426302::0.509162053681401,#H17:0.1968426302::0.490837946318599):0.05603563838,#H13:0::0.695621597080823):0.2327367459,((t4:0.4728885618,(t3:0.06939401066,t1:0.06939401066):0.4034945512):0.03839504799,(t2:0.5112836098)#H13:0::0.304378402919177):0.2327367459):0.105329951);&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>my_net<span class="ot">&lt;-</span><span class="fu">read.net</span>(<span class="at">text=</span>my_newick)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_net)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Evolutionary network with 2 reticulations</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                --- Base tree ---</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Phylogenetic tree with 8 tips and 12 internal nodes.</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tip labels:</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   t9, t8, t6, t7, t4, t3, ...</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Node labels:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   , , , , #H17, , ...</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rooted; includes branch lengths.</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my_net)<span class="do">##we can see that my_net has the inheritance element for inheritance probabilities</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 7</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ edge        : int [1:19, 1:2] 9 10 11 12 13 14 15 16 16 15 ...</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Nnode       : int 12</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ tip.label   : chr [1:8] &quot;t9&quot; &quot;t8&quot; &quot;t6&quot; &quot;t7&quot; ...</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ edge.length : num [1:19] 0.1053 0.2327 0.056 0.1968 0.0118 ...</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ node.label  : chr [1:12] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ reticulation: int [1:2, 1:2] 12 11 13 20</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ inheritance : num [1:2] 0.491 0.696</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr [1:2] &quot;evonet&quot; &quot;phylo&quot;</span></span></code></pre></div>
</div>
</div>
<div id="reconstructed-phylogenies-incomplete-sampling" class="section level2">
<h2>Reconstructed Phylogenies &amp; Incomplete Sampling</h2>
<p>Often not all extant tips on a phylogeny are sampled, nor do we have clear fossil records that tell us about the extinct species. We may wish to reflect this lack of knowledge by generating phylogenies with incomplete sampling or extinct lineages pruned. We can do this directly in the <code>sim.bdh</code> type functions by changing the <code>frac</code> and <code>stochsampling</code> arguments for incomplete sampling and by setting the <code>complete</code> argument to <code>FALSE</code> for the reconstructed phylogeny with extinct lineages removed. However, we can also do both of these actions post-hoc with the <code>incompleteSampling()</code> and <code>reconstructedNetwork()</code> functions.</p>
<div id="example-4-post-hoc-incomplete-sampling-an-reconstructed-networks" class="section level3">
<h3>Example 4: Post-hoc Incomplete Sampling an Reconstructed Networks</h3>
<p>Our GSA network had a few extinct lineages, we can try pruning those with <code>reconstructedNetwork</code>. We will then randomly subsample 5 out of the 7 extant tips.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pruned_gsa <span class="ot">&lt;-</span> <span class="fu">reconstructedNetwork</span>(gsa_net)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">plottable.net</span>(pruned_gsa),<span class="at">main=</span><span class="st">&#39;Reconstructed Phylogeny&#39;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pruned_gsa <span class="ot">&lt;-</span> <span class="fu">incompleteSampling</span>(pruned_gsa,<span class="at">rho=</span><span class="dv">5</span><span class="sc">/</span><span class="dv">7</span>,<span class="at">stochastic =</span> F)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">plottable.net</span>(pruned_gsa),<span class="at">main=</span><span class="st">&#39;Reconstructed Phylogeny with Incomplete Sampling&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAFQCAMAAABXmDxzAAAAt1BMVEUAAAAAADoAAGYAAH8AOjoAOmYAOpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmkGZmkLZmkNtmtttmtv+AgP+QOgCQZgCQZjqQkGaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2kJC227a229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb/9vb////tmb/25D/27b/29v//7b//9v////npdKUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM9klEQVR4nO3de3/a1gGH8YMTG+bUiXHX2mPd0sXZ0i2EuNuMmdH7f13TuegCSAc+tg76Ac/3jxjb6FL89AiBhEwGCDN9rwAQQ6CQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQdkqBLifGGbybvm4+//j24jvdm7Pw85lfGeNWZmYGnxrmMTEXj69Y0WNwioGaxhp2trg52x5o2502A3UrQ6BtTjNQM3zFbKrGXnCnhkBthATa5sQCdX/vp5H7uvycj17vfQAPl8a8vXU3f/8xv/mT/XFezd/y+5y7dL7n9xhcTW1iubNv+S//emPOpr6457G5rs8n3Km+jOXnkTn/WA/U3VqMbZvVovKVdP/3zI25K1a4WiU3w/NPfi7VzJsn39PDmtYpBprnk3/Nm7LOv2WhJ+Mam5WjWjnG+W2wCc2Vgfq7rQRazifcqbaMcvheC9QPnrPql+Hndr5hhWur5OcyuLT3qc28tqa1yXt5kLt2ioH6ETT/E07tzWs33Hx4zIey/G/qfzdzseb/nk/97TyG4WP24H7s//b5jy+m2X+yeqC1+fgfry5j+GjHvLVA/z32Vdq5uUXld79zMxyGFa6vkp/Lffg/pZx5bU1rkx+FEwu0cF2MebOqptnV13LkuQ/V3Lmch/af869hNmWgd9V3fm7r89lcxvO47TloyOo6bKTdJtoHWl+l2lzqM6+taW3yo3CagQ7duFRsFmv7IsXNsN21G/diLDPF88AiUL9bUwu0vk9zH4bj2jKG1d2zrHEv3o97oed8Vm6G9VUqbtu51GbeMvlROMVAzz9mboxZjyerNo1uBKr/2Rc3/s6/NgfqtrS1+fgf15ZRzHgjULfjtbIou5H2w6Prsb5K9bnUZt4y+VE4sUDzAemL393wz9Wqn6/eXB9Bc4u/XPrNcSzQjRF0fRkbe/HFN9WibOf++20j6F188qNwcoG6oWu4uhvhq5m/+7j+HLQeqJ3Bn2vPWEMD/uu8tvtUzWdzGSvPQVsCtd9cFvvs0eegw/jkR+EEA7WvAd3Zfwe39lXI/Ed5Xu/tSJX/eHUvvvyzu/1zu50vX1SvAs3vupgU+9jFfPyvV5dR7n9nfsK2QN2zy+tyhdv34suZN09+FE4x0PwvWL2M6DILr1/68ad80bH+Z/9c7dDMw+ugPtByX+V6ZT7+Tg3L2CFQm7j73U6vg67vY1WTH4VTDNS2Yvd7fsnbuvLHjbh3gH52N93bNu7myp/d3sMf2OHezJmWT/Oe8t2nq3/V30n6ubxTfRnLLyPz9naH56B+nKyvcLVKbr4/hLevqpk3T34UTinQg7H1Vcz4q0jH8yJoRqCK8qe6bZvofOx/H16Rf8nkB4hA1binlm37OMWLn+2vIkUnP0AEqiYvbPCh9beLH0fFi/svmfzwECikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikEaiWN2Yv3vT937kzAtWyp3L+tJ/FdIBAtRDoGgLVQqBrCFQLga4hUC0EuoZAtRDoGgLVQqBrCFQLga4hUC0EuoZAtRDoGgLVQqBrCFQLga4hUC0EuoZAtRDoGgLVQqBrCFQLga4hUC2HFejT6M59nV88Zqs3OkOgWg4r0Pngk/3yNLr235c3ukOgWg4r0NnZt8xmafxAWt7oEIFqOaxA74dZtvxtdOkG0vJGpwhUy4EE6s/tW07yLfr3d19n7plneaNTBKrlUAJ1/xb7SHYgXb3RHQLVclCBhn0kN5Cu3OgQgWo5qED9PlI5kFY3OkSgWg4q0LBFn/tOazc6RKBx+/mgj71/5EcngRZb9HLXKME+EoFuse/H55ACDVv05STsGpU3ukSgcQTayK1m2Ed6Hoddo/JGlwg0jkAb7e/Dxwg0jkAbEagK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" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="more-complex-hybridization-models" class="section level2">
<h2>More Complex Hybridization Models</h2>
<p>We can extend our model of hybridization in two main ways:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Make the probability of a successful hybridization a function of genetic distance.</strong> We can do this to model the belief that it is less likely for more distantly related taxa to hybridize. This function will take in the genetic distance between two taxa and return the probability that the hybridization is successful. We use the same matrix of genetic distances that is defined in <em><span class="citation">Woodhams, Lockhart, and Holland (2016)</span></em>. Briefly, the genetic distance between two non hybrid taxa <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is defined as the summation of all edge lengths on the path from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>. Genetic distances involving hybridized taxa is similar but hybridizations lead to multiple paths from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>; in this case we use a weighted summation across all different paths where the weight for each path depends on the inheritance probabilities.</p></li>
<li><p><strong>Make successful hybridizations depend on some trait that also evolves along the tree.</strong> This extension was made to model the belief that typically only lineages with the same ploidy and chromosome number can hybridize, although this can be generalized to model any discrete or continuous trait and rules for restricting hybridization.</p></li>
</ol>
<div id="example-5a-hybridizations-dependent-on-genetic-distance" class="section level3">
<h3>Example 5A: Hybridizations Dependent On Genetic Distance</h3>
<p>We can make the probability that a hybridization is successful by providing a function that is defined on the range <span class="math inline">\([0,\infty)\)</span> for genetic distances and returns values from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> for the probability of a successful hybridization. We have implemented several <code>make</code> functions for creating functions that fit these criteria. These functions are then used as the <code>hyb.rate.fxn</code> argument in the <code>sim.bdh</code> style functions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Here are some of the make functions</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">make.exp.decay</span>(<span class="at">t=</span><span class="dv">1</span>,<span class="at">s=</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">make.linear.decay</span>(<span class="at">threshold =</span> <span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">make.stepwise</span>(<span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>),<span class="at">distances =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="cn">Inf</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">make.polynomial.decay</span>(<span class="at">threshold =</span> <span class="dv">1</span>,<span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">##We can use any of these functions as the hyb.rate.fxn argument in a sim.bdh function</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>age_nets <span class="ot">&lt;-</span><span class="fu">sim.bdh.age</span>(<span class="at">age=</span><span class="dv">2</span>,<span class="at">numbsim=</span><span class="dv">10</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.25</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.rate.fxn =</span> f3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-5b-trait-dependent-hybridization" class="section level3">
<h3>Example 5B: Trait Dependent Hybridization</h3>
<p>We can model trait dependent hybridization by supplying a list for the argument <code>trait.model</code> in the <code>sim.bdh</code> functions. This list contains initial value(s) for the trait at the beginning of the process, functions describing how the trait evolves, and a function that dictates whether taxa can hybridize based on the trait values between taxa. Specifically the list contains these named elements:</p>
<ul>
<li><strong>initial</strong> The initial trait state on the phylogeny. <strong>NOTE:</strong> if the <code>MRCA</code> argument in the <code>sim.bdh</code> style funcitons is <code>TRUE</code>, 2 initial values will be needed since the process starts with 2 lineages.</li>
<li><strong>hyb.event.fxn</strong> A function that denotes the trait of a hybrid child after a hybridization event. The function should have the arguments <code>parent_states</code> and <code>inheritance</code>. <code>parent_states</code> is vector with the ploidy states of the hybrid parents while <code>inheritance</code> is the inheritance probability of the first lineage denoted in <code>parent_states</code>.</li>
<li><strong>hyb.compatability.fxn</strong> A function that describes when hybridization events can occur between two taxa based on their traits. The function should have the argument <code>parent_states</code>, a vector with the trait states of the two parents to the hybrid child. The function should return <code>TRUE</code> for when a hybridization event is allowed to proceed and <code>FALSE</code> otherwise.</li>
<li><strong>time.fxn</strong> A function that describes how traits change over time. The function should have the arguments <code>poly_states</code> and <code>timestep</code> in that order. <code>poly_states</code> is a vector containing the ploidy of all taxa while <code>timestep</code> is the amount of time given for trait evolution. The function should return a vector with the updated ploidy states of all taxa.</li>
<li><strong>spec.fxn</strong> A function that describes how the trait changes at speciation events.The function should have the argument <code>tip_state</code> which has the state of the lineage just before speciation. The function should return a vector with two values, one denoting the trait of each of the two new species after the event.</li>
</ul>
<p>We can use the <code>make.polyploid.model</code> to create a list containing all the nessecary elements. The default values of this model assumes that only taxa with similar ploidy can successful hybridize and that every hybridization is an allopolyploidy event that doubles the ploidy of the hybrid. We also assume that ploidy only changes at these allopolyploidy events.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Make a trait model</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plypld.model <span class="ot">&lt;-</span> <span class="fu">make.polyploid.model</span>(<span class="at">initial_states=</span><span class="dv">1</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hyb.event.fxn=</span><span class="fu">make.allopolyploid.event</span>(<span class="dv">1</span>), </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hyb.compatability.fxn=</span><span class="fu">make.states.incompatible</span>(), </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">time.fxn=</span><span class="cn">NULL</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">spec.fxn=</span><span class="cn">NULL</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">##These are the default values so one can use make.polyploid.model() for the same effect</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">##simulate Networks</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>age_nets <span class="ot">&lt;-</span><span class="fu">sim.bdh.age</span>(<span class="at">age=</span><span class="dv">2</span>,<span class="at">numbsim=</span><span class="dv">10</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.25</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trait.model =</span> plypld.model)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="do">##We can even combine the trait evolution component with the genetic distance dependency component</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>age_nets <span class="ot">&lt;-</span><span class="fu">sim.bdh.age</span>(<span class="at">age=</span><span class="dv">2</span>,<span class="at">numbsim=</span><span class="dv">10</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.25</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.rate.fxn =</span> f3,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trait.model =</span> plypld.model)</span></code></pre></div>
<p>Although <code>make.polyploid.model()</code> creates a relatively simple model for ploidy evolution and has basic rules for whether hybridizations can occur, users can create their own functions to model trait evolution and create their own rules for how they constrain hybridization.</p>
<p>For example, we may wish to model how ploidy can change over time with autopolyploidy events. We could assume that autopolyploidization is a poisson proccess with some rate <span class="math inline">\(\theta\)</span> where the ploidy doubles at these events. To model this we could create a function for the <code>time.fxn</code> argument to model how these lineages change over time.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>autopolyploid.fxn <span class="ot">&lt;-</span> <span class="cf">function</span>(poly_states,time){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="fl">0.01</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  doubles<span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="fu">length</span>(poly_states),theta<span class="sc">*</span>time) <span class="do">##the number of autopolyploid events for each lineage</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(poly_states<span class="sc">*</span>(<span class="dv">2</span><span class="sc">^</span>doubles))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="do">##Make a trait model but this time supply a time.fxn</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plypld.model <span class="ot">&lt;-</span> <span class="fu">make.polyploid.model</span>(<span class="at">initial_states=</span><span class="dv">1</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hyb.event.fxn=</span><span class="fu">make.allopolyploid.event</span>(<span class="dv">1</span>), </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hyb.compatability.fxn=</span><span class="fu">make.states.incompatible</span>(), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">time.fxn=</span>autopolyploid.fxn,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">spec.fxn=</span><span class="cn">NULL</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">##simulate Networks</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>age_nets <span class="ot">&lt;-</span><span class="fu">sim.bdh.age</span>(<span class="at">age=</span><span class="dv">2</span>,<span class="at">numbsim=</span><span class="dv">10</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="dv">1</span>,<span class="at">mu=</span><span class="fl">0.2</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nu=</span><span class="fl">0.25</span>, <span class="at">hybprops =</span> hybrid_proportions,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hyb.inher.fxn =</span> inheritance.fxn,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trait.model =</span> plypld.model)</span></code></pre></div>
</div>
</div>
</div>
<div id="works-cited" class="section level1 unnumbered">
<h1 class="unnumbered">Works Cited</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-BaridoSottani2019" class="csl-entry">
Barido-Sottani, Joëlle, Walker Pett, Joseph E. O’Reilly, and Rachel C. M. Warnock. 2019. <span>“FossilSim: An r Package for Simulating Fossil Occurrence Data Under Mechanistic Models of Preservation and Recovery.”</span> <em>Methods in Ecology and Evolution</em> 10 (6): 835–40. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.13170">https://doi.org/10.1111/2041-210X.13170</a>.
</div>
<div id="ref-Cardona2008" class="csl-entry">
Cardona, Gabriel, Francesc Rosselló, and Gabriel Valiente. 2008. <span>“Extended Newick: It Is Time for a Standard Representation of Phylogenetic Networks.”</span> <em>BMC Bioinformatics</em> 9 (1): 532. <a href="https://doi.org/10.1186/1471-2105-9-532">https://doi.org/10.1186/1471-2105-9-532</a>.
</div>
<div id="ref-Davin2020" class="csl-entry">
Davín, Adrián A., Théo Tricou, Eric Tannier, Damien M. de Vienne, and Gergely J. Szöllosi. 2020. <span>“Zombi: A Phylogenetic Simulator of Trees, Genomes and Sequences That Accounts for Dead Linages.”</span> <em>Bioinformatics</em> 36 (4): 1286–88. <a href="https://doi.org/10.1093/bioinformatics/btz710">https://doi.org/10.1093/bioinformatics/btz710</a>.
</div>
<div id="ref-Hagen2018" class="csl-entry">
Hagen, Oskar, and Tanja Stadler. 2018. <span>“TreeSimGM: Simulating Phylogenetic Trees Under General Bellman–Harris Models with Lineage-Specific Shifts of Speciation and Extinction in r.”</span> <em>Methods in Ecology and Evolution</em> 9 (3): 754–60. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.12917">https://doi.org/10.1111/2041-210X.12917</a>.
</div>
<div id="ref-Hartmann2010" class="csl-entry">
Hartmann, Klaas, Dennis Wong, and Tanja Stadler. 2010. <span>“<span class="nocase">Sampling Trees from Evolutionary Models</span>.”</span> <em>Systematic Biology</em> 59 (4): 465–76. <a href="https://doi.org/10.1093/sysbio/syq026">https://doi.org/10.1093/sysbio/syq026</a>.
</div>
<div id="ref-Hoehna2013" class="csl-entry">
Höhna, Sebastian. 2013. <span>“<span class="nocase">Fast simulation of reconstructed phylogenies under global time-dependent birth–death processes</span>.”</span> <em>Bioinformatics</em> 29 (11): 1367–74. <a href="https://doi.org/10.1093/bioinformatics/btt153">https://doi.org/10.1093/bioinformatics/btt153</a>.
</div>
<div id="ref-Hoehna2015" class="csl-entry">
Höhna, Sebastian, Michael R. May, and Brian R. Moore. 2015. <span>“<span class="nocase">TESS: an R package for efficiently simulating phylogenetic trees and performing Bayesian inference of lineage diversification rates</span>.”</span> <em>Bioinformatics</em> 32 (5): 789–91. <a href="https://doi.org/10.1093/bioinformatics/btv651">https://doi.org/10.1093/bioinformatics/btv651</a>.
</div>
<div id="ref-Mallet2016" class="csl-entry">
Mallet, James, Nora Besansky, and Matthew W. Hahn. 2016. <span>“How Reticulated Are Species?”</span> <em>BioEssays</em> 38 (2): 140–49. <a href="https://doi.org/10.1002/bies.201500149">https://doi.org/10.1002/bies.201500149</a>.
</div>
<div id="ref-Morin2006" class="csl-entry">
Morin, M. M., and B. M. E. Moret. 2006. <span>“<span>NetGen</span>: Generating Phylogenetic Networks with Diploid Hybrids.”</span> <em>Bioinformatics</em> 22 (15): 1921–23. <a href="https://doi.org/10.1093/bioinformatics/btl191">https://doi.org/10.1093/bioinformatics/btl191</a>.
</div>
<div id="ref-Nee2006" class="csl-entry">
Nee, Sean. 2006. <span>“Birth-Death Models in Macroevolution.”</span> <em>Annual Review of Ecology, Evolution, and Systematics</em> 37 (1): 1–17. <a href="https://doi.org/10.1146/annurev.ecolsys.37.091305.110035">https://doi.org/10.1146/annurev.ecolsys.37.091305.110035</a>.
</div>
<div id="ref-Stadler2011" class="csl-entry">
Stadler, Tanja. 2011. <span>“<span class="nocase">Simulating Trees with a Fixed Number of Extant Species</span>.”</span> <em>Systematic Biology</em> 60 (5): 676–84. <a href="https://doi.org/10.1093/sysbio/syr029">https://doi.org/10.1093/sysbio/syr029</a>.
</div>
<div id="ref-Wen2018" class="csl-entry">
Wen, Dingqiao, Yun Yu, Jiafan Zhu, and Luay Nakhleh. 2018. <span>“<span>Inferring Phylogenetic Networks Using PhyloNet</span>.”</span> <em>Systematic Biology</em> 67 (4): 735–40. <a href="https://doi.org/10.1093/sysbio/syy015">https://doi.org/10.1093/sysbio/syy015</a>.
</div>
<div id="ref-Woodhams2016" class="csl-entry">
Woodhams, Michael D., Peter J. Lockhart, and Barbara R. Holland. 2016. <span>“Simulating and <span>Summarizing</span> <span>Sources</span> of <span>Gene</span> <span>Tree</span> <span>Incongruence</span>.”</span> <em>Genome Biology and Evolution</em> 8 (5): 1299–1315. <a href="https://doi.org/10.1093/gbe/evw065">https://doi.org/10.1093/gbe/evw065</a>.
</div>
<div id="ref-Zhang2018" class="csl-entry">
Zhang, Chi, Huw A. Ogilvie, Alexei J. Drummond, and Tanja Stadler. 2018. <span>“Bayesian <span>Inference</span> of <span>Species</span> <span>Networks</span> from <span>Multilocus</span> <span>Sequence</span> <span>Data</span>.”</span> <em>Molecular Biology and Evolution</em> 35 (2): 504–17. <a href="https://doi.org/10.1093/molbev/msx307">https://doi.org/10.1093/molbev/msx307</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
